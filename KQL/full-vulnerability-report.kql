//Get List of All Vulnerabilities on All Systems
//Note: To specify severity, uncomment line 8. Otherwise all severities will be returned.

let devices = dynamic([ ['device-name-1'], ['device-name-2']]);
DeviceTvmSoftwareVulnerabilitiesKB
| join DeviceTvmSoftwareVulnerabilities on CveId
| where DeviceName in~ (devices)
//| where VulnerabilitySeverityLevel =~ "Critical"
| summarize by DeviceName, CveId, VulnerabilitySeverityLevel, PublishedDate, IsExploitAvailable, SoftwareName, SoftwareVersion, VulnerabilityDescription, RecommendedSecurityUpdate
